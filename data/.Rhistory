?krige
install.packages("sp")
install.packages("rgdal")
install.packages("gstat")
install.packages("rgeos")
install.packages("raster")
load("C:/Users/Jochem/Downloads/part1.Rdata")
View(geul)
View(geul)
View(geul)
?krige
??krige
?krige.cv
??krige.cv
View(geul.xv2)
View(geul)
View(geul)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = resid~1, data=resids)
vgpb = variogram (gpb)
plot(vgpb)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = resid~1, data=resids)
vgpb = variogram (gpb)
plot(vgpb)
vgmpb <- vgm(nugget = 3000, psill = 27000, range = 170, model = "Exp")
plot(vgpb, vgmpb, plot.nu = T)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = resid~1, data=resids)
vgpb = variogram (gpb)
plot(vgpb)
vgmpb <- vgm(nugget = 3000, psill = 27000, range = 170, model = "Exp")
plot(vgpb, vgmpb, plot.nu = T)
vgmpb <- fit.variogram(vgpb, vgmpb)
plot(vgpb, vgmpb)
??vgm
??variogram
??vgm
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = resid~1, data=resids)
vgpb = variogram (gpb)
plot(vgpb)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = resid~1, data=resids)
vgpb = variogram (gpb)
plot(vgpb)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = log(resid)~1, data=resids)
vgpb = variogram (gpb)
plot(vgpb)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gpb = gstat(formula = resid~1, data=resids)
vgpb = variogram (gpb, cutoff=5000, width=150)
plot(vgpb)
vgpb = variogram (gpb, boundaries(c(1:5*100), 3:10*500))
vgpb = variogram (gpb, boundaries = c(1:5*100, 3:10*500))
plot(vgpb)
vgpb = variogram (gpb, boundaries = c(1:5*100, 3:14*500))
plot(vgpb)
length(resids)
vgpb = variogram (gpb, boundaries = c(1:5*50, 3:14*500))
plot(vgpb)
vgpb = variogram (gpb, boundaries = c(1:5*100, 3:14*500))
plot(vgpb)
vgpb = variogram (gpb, boundaries = c(1:5*100, 10:14*500))
plot(vgpb)
vgpb = variogram (gpb, boundaries = c(1:5*100, 3:14*500))
plot(vgpb)
vgpb = variogram (gpb, boundaries = c(0, 1:5*100, 3:14*500))
plot(vgpb)
vgpb = variogram (gpb, boundaries = c(1:5*100, 3:14*500))
plot(vgpb)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgpb, vgmpb)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
library(sp)
library(rgdal)
library(gstat)
library(rgeos)
# set path
setwd("D:/Studie/urban_sprawl_group6/data")  # specify proper path
resids <- read.table("Sample_error.txt", header = TRUE)
coordinates(resids) <- ~x+y
# variogram model
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Gau")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Sph")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Mat")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:8*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*50, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 5:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 8000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:14*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 3000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:20*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 10000, range = 6000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:20*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 12000, range = 10000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:10*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 12000, range = 10000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
# variogram model
gres = gstat(formula = resid~1, data=resids)
vgres = variogram (gres, boundaries = c(1:5*100, 3:10*500))
plot(vgres)
vgmres <- vgm(nugget = 3800, psill = 9000, range = 5000, model = "Exp")
plot(vgres, vgmres, plot.nu = T)
vgmres <- fit.variogram(vgres, vgmres)
plot(vgres, vgmres)
ahn <- readGDAL("ahn100_f.asc")
# cross-validation
resids.xv1 <- krige.cv(resid~1, resids, vgmres)
resids.xv1 <- krige.cv(resid~1, resids, vgmres, nmax=24)
View(resids.xv1)
resids.xv1 <- krige.cv(res~1, resids, vgmres)
str(resids.xv1)
hist(resids.xv1$var1.pred)
names(resids.xv1)
mean(resids.xv1$zscore)
sd(resids.xv1$zscore)
hist(resids.xv1$zscore,breaks=seq(-3.5,3.5, by=1))
hist(resids.xv1$zscore,breaks=seq(-1,1, by=1))
hist(resids.xv1$zscore,breaks=seq(-400,400, by=1))
hist(resids.xv1$zscore,breaks=seq(-10,10, by=1))
hist(resids.xv1$zscore,breaks=seq(-50,50, by=1))
hist(resids.xv1$zscore,breaks=seq(-15,15, by=1))
bubble(resids.xv1, zcol = "residual", maxsize = 3, key.entries =
c(-330,-200, -100,-50,0,50,100,200,330), main =
"cross-validation residuals, OK" )
View(resids)
resids.xv1 <- krige.cv(resid~1, resids, vgmres, nmax=24)
str(resids.xv1)
hist(resids.xv1$var1.pred)
names(resids.xv1)
mean(resids.xv1$zscore)
sd(resids.xv1$zscore)
hist(resids.xv1$zscore,breaks=seq(-15,15, by=1))
# Bubble plot residuals
bubble(resids.xv1, zcol = "residual", maxsize = 3, key.entries =
c(-330,-200, -100,-50,0,50,100,200,330), main =
"cross-validation residuals, OK" )
# Add residuals to AHN and make SpatialPixelsDataFrame object
# it is assumed that predicted residuals are in "resid"
defaultdem <- data.frame(band1 = ahn$band1 + resids.xv1$var1.pred)
coordinates(defaultdem) <- coordinates(ahn)
gridded(defaultdem) <- TRUE
spplot(defaultdem, col.regions=bpy.colors())
write.asciigrid(defaultdem, "defaultdem.asc") # write to disk
# residsim maken met kriging stochastic simulation
set.seed(12345)
residsim <- krige(resid~1, ahn, newdata=mask, vgmres, nsim=100, nmax=24)
# residsim maken met kriging stochastic simulation
set.seed(12345)
resid.sim <- krige(resid~1, ahn, newdata=mask, vgmres, nsim=100, nmax=24)
set.seed(12345)
residsim <- krige(resid~1, resids, newdata=mask, vgmres, nsim=100, nmax=24)
outroot = "D:/Studie/urban_sprawl_group6/data/dem" # (mind forward slashes)
for(i in 1:2)
{
outname <- paste0(outroot, i, ".asc")
outdem <- data.frame(band1 = ahn$band1 + residsim[[i]])
coordinates(outdem) <- coordinates(ahn)
gridded(outdem) <- TRUE
write.asciigrid(outdem, outname)
}
View(residsim)
View(mask)
View(mask)
# residsim maken met kriging stochastic simulation
set.seed(12345)
residsim <- krige(resid~1, resids, newdata=mask, vgmres, nsim=100, nmax=24)
View(residsim)
outroot = "D:/Studie/urban_sprawl_group6/data/dem" # (mind forward slashes)
for(i in 1:2)
{
outname <- paste0(outroot, i, ".asc")
outdem <- data.frame(band1 = ahn$band1 + residsim[[i]])
coordinates(outdem) <- coordinates(ahn)
gridded(outdem) <- TRUE
spplot(outdem, col.regions=bpy.colors())
write.asciigrid(outdem, outname)
}
outroot = "D:/Studie/urban_sprawl_group6/data/dem" # (mind forward slashes)
for(i in 1:2)
{
outname <- paste0(outroot, i, ".asc")
outdem <- data.frame(band1 = ahn$band1 + residsim[[paste0('sim'+ i)]])
coordinates(outdem) <- coordinates(ahn)
gridded(outdem) <- TRUE
spplot(outdem, col.regions=bpy.colors())
write.asciigrid(outdem, outname)
}
residsim[[1]]
count(residsim[[1]] != 'NA')
(residsim[[1]] != 'NA')
(residsim[[2]] != 'NA')
for(i in 1:2)
{
outname <- paste0(outroot, i, ".asc")
outdem <- data.frame(band1 = ahn$band1 + residsim[[i]])
coordinates(outdem) <- coordinates(ahn)
gridded(outdem) <- TRUE
spplot(outdem, col.regions=bpy.colors())
write.asciigrid(outdem, outname)
}
count(!is.na(residsim[1]))
